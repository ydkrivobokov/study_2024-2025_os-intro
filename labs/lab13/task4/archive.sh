#!/bin/bash
# Указываем, что скрипт должен выполняться в Bash

# Проверка наличия обязательного аргумента (директории)
if [ -z "$1" ]; then
  echo "Использование: $0 директория [имя_архива]" >&2
  exit 1
fi

# Сохраняем переданные аргументы в переменные
dir="$1"  # Первый аргумент — директория для архивации
archive_name="${2:-recent_files.tar.gz}"  # Второй аргумент (если нет, используем значение по умолчанию)

# Проверка существования директории
if [ ! -d "$dir" ]; then
  echo "Директория $dir не существует" >&2
  exit 1
fi

# Находим файлы, измененные за последние 7 дней, и архивируем их
find "$dir" -type f -mtime -7 -print0 | tar -czvf "$archive_name" --null -T -
# Пояснение:
#   find:
#     "$dir"       — ищем в указанной директории.
#     -type f      — только файлы (не директории).
#     -mtime -7    — измененные менее 7 дней назад.
#     -print0      — вывод с разделителем \0 (для обработки пробелов в именах).
#   tar:
#     -czvf        — создает (.c) gzip-архив (.z), verbose (-v), с указанным именем (-f).
#     --null       — читает имена файлов с разделителем \0.
#     -T -         — берет список файлов из stdin (из find).

echo "Создан архив $archive_name с файлами, измененными за последнюю неделю"
